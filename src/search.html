---
layout: page
permalink: /pesquisa/
title: Pesquisa
---

<h3 id="search-result-title"></h3>
<div id="search-result"></div>

<script>
var urlParams = new URLSearchParams(window.location.search);
var query = urlParams.get('q');

$('title').text($('title').text().replace('Pesquisa', query));
$('#search-result-title').text("Resultado da pesquisa por \"" + query + "\"");
var regex = new RegExp(query, "i");
var resultElement = $("#search-result");

$.getJSON("/search.json", function(json) {
    var lastCategory = null;
    var lastCategoryElement = null;

    var posts = $(json).filter(function (i,p) {
        if(hasQuery(p, regex)) {
            if (lastCategory != p.category) {
                resultElement.append("<h3>"+ jd.getCategory(p) + " " + jd.getIcon(p) + "</h3>" );
                lastCategoryElement = resultElement.append("<ul></ul>");
                lastCategory = p.category;
            }

            lastCategoryElement.append("<li title='" + jd.getCategory(p) + "'><a href='" + p.url + "'>" + p.title + "</a></li>");
        }
    });       
});

function hasQuery(post, regex) {
    return post.title.search(regex) != -1
        || post.tags.search(regex) != -1
        || post.author.search(regex) != -1;
}
</script>
